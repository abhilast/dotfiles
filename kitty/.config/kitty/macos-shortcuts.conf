# ============================================================================
# macOS Keyboard Shortcuts Configuration for Kitty
# ============================================================================
#
# RECENT ADDITIONS:
# - Cmd+Shift+Left/Right: Move tab left/right
# - Cmd+Shift+N: Detach window to new tab
# - Cmd+Option+1-9: Jump to specific window (like tab jumping with Cmd+1-9)
# - Cmd+Ctrl+S: Save current session
# - Cmd+Ctrl+L: Load session (info)
# - Cmd+F: Enhanced scrollback search with fzf (fuzzy search)
#
# ============================================================================
# ALT/OPTION KEY CONFIGURATION
# ============================================================================

# Enable Option key as Alt for Neovim and other terminal programs
# Options: no, yes, left, right, both
# - 'right' = Only right Option acts as Alt (recommended - keeps left Option for macOS word navigation)
# - 'both' = Both Option keys act as Alt
macos_option_as_alt right

# ============================================================================
# TAB MANAGEMENT (CMD+NUMBER STYLE)
# ============================================================================

# Jump to specific tabs
map cmd+1 goto_tab 1
map cmd+2 goto_tab 2
map cmd+3 goto_tab 3
map cmd+4 goto_tab 4
map cmd+5 goto_tab 5
map cmd+6 goto_tab 6
map cmd+7 goto_tab 7
map cmd+8 goto_tab 8
map cmd+9 goto_tab 9

# Tab operations
map cmd+t new_tab
map cmd+w close_tab
map cmd+shift+] next_tab
map cmd+shift+[ previous_tab
map cmd+shift+t set_tab_title

# Move tabs
map cmd+shift+left move_tab_backward
map cmd+shift+right move_tab_forward

# ============================================================================
# WINDOW MANAGEMENT (SPLITS/PANES)
# ============================================================================

# Create splits (requires 'splits' layout to be enabled)
# Vertical split (new window to the right)
map cmd+d launch --location=vsplit --cwd=current

# Horizontal split (new window below)  
map cmd+shift+d launch --location=hsplit --cwd=current

# Smart split based on current layout
# map cmd+enter launch --location=split --cwd=current (removed - conflicts with fullscreen)

# Navigate between windows/panes
map cmd+option+left neighboring_window left
map cmd+option+right neighboring_window right
map cmd+option+up neighboring_window up
map cmd+option+down neighboring_window down

# Jump to specific window (like tab jumping)
map cmd+option+1 nth_window 0
map cmd+option+2 nth_window 1
map cmd+option+3 nth_window 2
map cmd+option+4 nth_window 3
map cmd+option+5 nth_window 4
map cmd+option+6 nth_window 5
map cmd+option+7 nth_window 6
map cmd+option+8 nth_window 7
map cmd+option+9 nth_window 8

# Resize windows
map cmd+ctrl+left resize_window narrower 2
map cmd+ctrl+right resize_window wider 2
map cmd+ctrl+up resize_window taller 2
map cmd+ctrl+down resize_window shorter 2

# Close window/pane
map cmd+shift+w close_window

# Detach window to new tab
map cmd+shift+n detach_window new-tab

# ============================================================================
# TEXT OPERATIONS
# ============================================================================

# Copy/Paste
map cmd+c copy_to_clipboard
map cmd+v paste_from_clipboard

# Font size adjustment
map cmd+plus change_font_size all +1.0
map cmd+minus change_font_size all -1.0
map cmd+0 change_font_size all 0

# Select all
map cmd+a select_all

# ============================================================================
# SCROLLING & NAVIGATION
# ============================================================================

# Page scrolling
map cmd+up scroll_page_up
map cmd+down scroll_page_down
map cmd+home scroll_home
map cmd+end scroll_end

# Line scrolling
map option+up scroll_line_up
map option+down scroll_line_down

# Search in scrollback with fzf (fuzzy search) - falls back to less if fzf not available
map cmd+f launch --type=overlay --stdin-source=@screen_scrollback /bin/sh -c "if command -v fzf >/dev/null 2>&1; then fzf --ansi; else /usr/bin/less +G -R; fi"

# Save scrollback to file
map cmd+shift+s launch --type overlay --stdin-source=@screen_scrollback --stdin-add-formatting /bin/sh -c "cat > /tmp/kitty-scrollback-$(date +%Y%m%d-%H%M%S).txt && echo 'Scrollback saved to /tmp/'"

# ============================================================================
# WINDOW RESIZING
# ============================================================================

# Resize windows with Cmd+Shift+HJKL (vim-style)
map cmd+shift+h resize_window narrower 2
map cmd+shift+k resize_window taller 2
map cmd+shift+j resize_window shorter 2

# Reset window sizes
map cmd+shift+0 resize_window reset

# ============================================================================
# SESSION MANAGEMENT
# ============================================================================

# Clear screen and scrollback
map cmd+k clear_terminal clear active

# Reload config
map cmd+shift+r load_config_file

# Session save/load
map cmd+ctrl+s launch --type=overlay --stdin-source=none /bin/sh -c "kitty @ ls > ~/.config/kitty/last-session.json && echo 'Session saved to ~/.config/kitty/last-session.json'"
map cmd+ctrl+l launch --type=overlay --stdin-source=none /bin/sh -c "if [ -f ~/.config/kitty/last-session.json ]; then echo 'Session restore requires manual setup. See kitty docs.'; else echo 'No saved session found.'; fi"

# Open URL hints (shows clickable URLs)
map cmd+shift+u kitten hints

# Toggle fullscreen
map cmd+enter toggle_fullscreen

# ============================================================================
# ADVANCED FEATURES
# ============================================================================

# Unicode input
map cmd+ctrl+space kitten unicode_input

# Open file paths in editor
map cmd+shift+o kitten hints --type path

# Unicode input (includes emoji)
map cmd+shift+e kitten unicode_input

# ============================================================================
# LAYOUT MANAGEMENT
# ============================================================================

# Switch layouts
map cmd+shift+l next_layout

# Common layouts shortcuts
map cmd+shift+z toggle_layout stack
map cmd+shift+p toggle_layout tall
map cmd+shift+f toggle_layout fat

# ============================================================================
# QUICK TIPS
# ============================================================================

# 1. Right Option as Alt: This setup uses right Option as Alt for Neovim
#    while keeping left Option for macOS word navigation
#
# 2. Window vs Tab: 
#    - Tabs (Cmd+T): Separate terminal sessions
#    - Windows/Splits (Cmd+D): Multiple panes in same tab
#
# 3. For Neovim users:
#    - Alt+key combinations will work with right Option key
#    - Example: Right Option+h/j/k/l for navigation in Neovim
#    - Left Option still works for word navigation in terminal
#
# 4. Scrollback search (Cmd+F):
#    - '/' to search forward
#    - '?' to search backward
#    - 'n'/'N' for next/previous match
#
# 5. URL hints (Cmd+Shift+O):
#    - Opens clickable hints for all URLs in view
#    - Press the hint key to open URL in browser